# vi简介
* vi：终端中的编辑器
* 学习vi的目的：
  * 在工作中，要对服务器上的文件进行简单的修改，可以使用ssh远程登录到服务器上，并使用vi进行快速的编辑
    * 常见需要修改的文件：
      * 源程序
      * 配置文件，如：ssh的配置文件~/.ssh/config
  * 在没有图形界面的环境下，vi是编辑文件的最佳选择
  * 每一个要使用linux的程序员，都应该或多或少学习一些vi的常用命令
* vi和vim：
  * 在很多linux发行版中，直接把vi做成vim的软连接
  * vi：
    * visual interface的简称，是linux中最经典的文本编辑器
    * vi的核心思想：
      * 让程序员的手指始终保持在**键盘的核心区域**，就能完成所有的编辑操作
    * vi的特点：
      * 没有图形界面的功能强大的编辑器
      * 只能是编辑文本内容，不能对字体、段落进行排版
      * 不支持**鼠标**操作
      * 没有菜单
      * 只有**命令**
    * vi编辑器在系统管理、服务器管理编辑文本时，其功能永远不是图形界面的编辑器能比拟的
  * vim:
    * vi improved
    * 编辑器之神
    * 从vi发展出来的一个文本编辑器，支持代码补全、编译及错误跳转等方便编程的功能

# 打开和新建文件
* 在终端中输入vi+文件名
  * `$ vi 文件名`
  * 若文件已存在，则直接打开该文件
  * 若文件不存在，则新建一个文件
* 打开文件并且定位行
  * 例子：在开发时，知道某一行代码存在错误，可以快速定位到出错代码的位置
  * `$ vi 文件名 +行数`
  * 若只带上+而不指定行号，则会直接定位到文件末尾
  
# 异常处理：
* 若vi异常退出，则在磁盘上可能会保存有交换文件
* 下次使用vi编辑该文件时，按下字母d可以删除交换文

# 三种工作模式：
* vi的3种基本工作模式：
  * 命令模式：
    * 打开文件首先进入命令模式，是使用vi的入口
    * 通过命令对文件进行常规的编辑操作，如：定位、翻页、复制、粘贴、删除等
    * 在其他图形编辑器下，通过快捷键或者鼠标实现的操作，都在命令模式下实现
  * 末行模式：
    * 执行保存、退出等操作
    * 要退出vi返回到控制台，需要在末行模式下输入命令
    * 末行模式是vi的出口
  * 编辑模式:
    * 正常的编辑文字
* 末行模式的命令：
  * w：write，保存
  * q：quit，退出，若没有保存则不允许退出
  * q!：强行退出，不保存退出
  * wq：write & quit，保存并退出
  * x：保存并退出
  
# 常用命令
* 命令线路图：
  * 重复次数：（自己实践下）
    * 在**命令模式**下，先输入一个数字，再跟上一个命令，可以让该命令重复执行指定次数
    * 可以是移动选择、编辑操作命令
  * 移动和选择：（多练）
    * 移动操作是基础！
    * vi之多以快，关键在于能够提供丰富的移动光标的命令，能够**快速定位**到要编辑的代码行
    * 移动命令能够和编辑操作命令**组合使用**
  * 编辑操作：
    * 删除、复制、粘贴、替换、缩排
  * 撤销和重复
  * 查找替换
  * 编辑
* 注：
  * vi的命令较多，不要期望一下子全部记住
  * 在使用vi命令时，注意关闭**中文输入法**
    * 在**命令模式**下，屏幕不会显示输入的命令
## 移动：（基本）
* 要熟练使用vi，首先应该学会怎么在**命令模式**下**快速移动光标**
* 编辑操作命令，能够和移动命令结合在一起使用
* 手指从字母区域切换到箭头区域影响开发效率
* 方向：上下左右每次只能移动一个字符

|命令|功能|手指|
|-|-|-|
|h|向左|食指|
|j|向下|食指|
|k|向上|中指|
|l|向右|无名指|

* 行内移动：

|命令|英文|功能|
|-|-|-|
|w|word|向后移动一个单词|
|b|back|向前移动一个单词|
|0||行首|
|^||行首，第一个不是空白字符的位置|
|$||行尾|

* 行数移动：
  * 开发中更多情况是跳转到某一行代码
  * 跳转到对应行的第一个非空字符处

|命令|英文|功能|
|-|-|-|
|gg|go|文件顶部|
|G|go|文件末尾|
|数字gg|go|移动到数字对应行数|
|数字G|go|移动到数字对应行数|
|:数字||末行模式，移动到数字对应行数|

* 屏幕移动：

|命令|英文|功能|
|-|-|-|
|Ctrl+b|back|向上翻页|
|Ctrl+f|forward|向下翻页|
|H|Head|屏幕保持不动，屏幕顶部|
|M|Middle|屏幕保持不动，屏幕中间|
|L|Low|屏幕保持不动，屏幕底部|

## 移动（程序）
* 程序员比较常用的移动光标的命令
* 段落移动：
  * vi中使用**空行**来区分段落
  * 在程序开发时，通常一段功能相关的代码会写在一起，之间没有空行

|命令|功能|
|-|-|
|{|上一段|
|}|下一段|

* 括号切换：
    * 在程序世界中，()、[]、{}使用频率很高，而且都是**成对出现**的

|命令|功能|
|-|-|
|%|括号匹配及切换|

* 标记：
  * 在开发时，某一块代码可能**需要稍后处理**，如：编辑、查看
  * 先使用`m`增加一个标记，**在需要时快速地跳转回来**或者执行其他编辑操作
  * 标记名称可以是`a~z`或者`A~Z`之间的任意一个字母
  * 添加了标记的行若被删除，则标记同时被删除
  * 若在其他行添加了相同名称的标记，则之前添加的标记也会被替换掉，即不复存在
  * 可以在多个行添加多个不同的标记
  
|命令|英文|功能|
|-|-|-|
|mx|mark|添加标记x，x是`a~z`或者`A~Z`之间的任意**一个**字母|
|'x||直接定位到标记x所在位置|

* 选中文本（可视模式）：
  * 学习复制命令前，应该先学会怎样选中要复制的代码
  * 在vi中要选择文本，需要先使用visual命令切换到可视模式
  * vi中提供了3种可视模式，可以方便程序员选择选中文本的方式
  * 按ESC可以放弃选中，返回到命令模式
  * v：可视模式，从光标位置开始按照正常模式选择文本
  * V：可视行模式，选择光标经过的完整行
  * Ctrl+v，可视块模式，垂直方向选中文本
  * 可视模式下，可以和移动命令连用，如：ggVG能够选中所有内容

# 撤销和恢复撤销
* 在学习编辑命令之前，先要知道怎样撤销之前一次错误的编辑动作
* u：undo，撤销上次命令
* Ctrl+r：redo，恢复撤销的命令

# 删除文本
* x：cut，删除光标所在字符，或者选中文字
* d（移动命令）：delete，删除移动命令对应的内容
* dd：delete，删除光标所在行，可以ndd复制多行
* D：delete，删除只行尾
* 若使用可视模式已经选中了一段文本，则无论使用d还是x，都可以删除选中文本
* 删除命令和移动命令连用，常见的组合命令：
  * dw：从光标位置删除至单词末尾
  * d0：从光标位置删除至一行的起始位置
  * d}：从光标位置删除到段落结尾
  * d代码行G：从光标所在行删除到指定代码行之间的所有代码
  * d'a：从光标所在行删除到标记a之间的所有代码
# 复制、粘贴
* vi中提供有一个被复制文本的缓冲区
  * 复制命令会将选中的文字保存在缓冲区
  * 删除命令删除的文字会被保存在缓冲区
  * 在需要的位置，使用粘贴命令可以将缓冲区的文字插入到光标所在位置
* y（移动命令）：copy，复制
* yy：copy，复制一行，可以nyy复制多行
* p：paste，粘贴
* 提示：
  * 命令d、x类似于图形界面的剪切操作
  * 命令y类似于图形界面的复制操作
  * 命令p类似于图形界面的粘贴操作
  * vi中的文本缓冲区同样只有一个，若后续做过复制、剪切等操作，则之前的缓冲区中的内容会被替换
* 注意：
  * vi中的文本缓冲区和系统的剪切板不是同一个
  * 在其他软件中使用Ctrl+C复制的内容，不能在vi中通过p命令粘贴
  * 可以在编辑模式下使用鼠标右键粘贴
# 替换
  * r：replace，替换当前字符，命令模式
  * R：replace，替换当前行光标后的字符，替换模式
  * R命令可以进入替换模式，替换完成后，按下esc可以回到命令模式
  * 替换命令的作用是不用进入编辑模式，对文件进行轻量级的修改
# 缩排和重复执行
* >>：向右增加缩进
* <<：向左减少缩进
* .：重复上次命令
* 缩排命令在开发程序时，统一增加代码的缩进比较有用
  * 一次性在选中代码前增加4个空格，叫做增加缩进
  * 一次性在选在代码前删除4个空格，叫做减少缩进
* 在可视模式下，缩排命令只需要使用一个>或者<
* 在程序中，缩进通常用来表示代码的归属关系
  * 前面空格越少，代码的级别越高
  * 前面空格越多，代码的级别越低
    
# 查找
* 常规查找：
  * /str：查找str
* 查找到指定内容后，使用next查找下一个出现的位置：
  * n：查找下一个
  * N：查找上一个
* 若不想看到高亮显示，则可以随便查找一个文件中不存在的内容即可
* 单词快速匹配：
  * `*`：向后查找当前光标所在单词
  * #：向前查找当前光标所在单词
* 在开发中，通过单词快速匹配，可以快速看到这个单词在其他什么位置使用过

  
    
