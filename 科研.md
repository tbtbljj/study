## 背景（Introduction）
---

## 方法（Methods）
### 数据模型
* 表达式  
  * 标量形式：空间维度（多导联），时间维度，上标  
  * 符号的含义：`EEG`，诱发成分`SSVEP`，自发脑电
* 系统框图
### 信号模型
**Volterra 滤波器：**  
* 表达式  
  * 多维离散卷积  
  * 系统的`p`阶核  
* 系统框图
* 系统的性质
  * 非线性系统：输入延时相乘
  * 动态系统
  * 因果系统
* VF稳态响应
  * 刺激信号：两个正弦信号的叠加，数字角频率与模拟频率的关系；当正弦信号的频率相同时即为一个正弦信号
  * 一阶响应的表达式：
  * 二阶响应的表达式：
  * `p`阶响应的频率分量： 
    * 能够刻画最高`p`次谐波及`p`阶交调现象
  * 频率响应：
    * 定义式
    * 幅度、相位符号的含义
  * 含义：
    * 除了刺激频率外，还产生新的频率分量，即谐波和交调分量
    * 响应中的频率分量，存在对应频率响应处的幅度加权及相差
### 模型参数估计
**最小二乘：**
* **向量形式**的信号模型：对不同导联分别进行建模，相同导联的模型能够刻画所有的目标，导联用上标进行标识，目标用下标进行标识
* **数据矩阵**的构造：
* **参数向量**的构造：系统的`p`阶Volterra 核
* 理解：
  * **非线性**体现在输入延时的乘积上
  * **线性性**体现在滤波器系数在输出表达式中是线性的
* **最小二乘解**：
  * 表达式
## FBCCA和联合CCA
---
## 实验（Experiment）

## 结果（Result）
### `VF`响应与`SSVEP`的对比
* 以`OZ`导联为例
* 模型对比：
  * 3种模型：
    * `VF`
    * `AR`模型
    * `QP`模型：`Quadratic polynomial`模型
  * 数据：
    * 8个目标（8:15Hz），1个目标1s数据，共8s数据
  * 对比：
    * 时域波形对比，并计算出归一化均方误差`nmse`
    * 频域幅度谱对比
* 典型结果：
  * 16个目标的时域辨识结果：
    * 4*4 排列
    * 横坐标：time/s；纵坐标：amplitude/uV
    * 2条曲线：`VF`响应、`SSVEP`
  * `VF`频率响应与`SSVEP`基波、二次谐波的幅度和相位：**正则化**、**泛化能力**、降低自发脑电的影响
    * `VF`幅频响应H1与`SSVEP`基波幅度
    * `VF`相频响应H1与`SSVEP`基波相位
    * `VF`幅频响应H2与`SSVEP`二次谐波幅度
    * `VF`相频响应H2与`SSVEP`二次谐波相位
* 似潜伏期：
  * 计算公式
  * `SSVEP`平均基波相位
    * LS拟合直线
  * 分别计算每个被试的似潜伏期，画出均值和标准差
### 基于`VF`模型的跨目标迁移算法


## 结论（Conclusion）
---
## 稳态视觉诱发电位脑-机接口中基于模型的迁移算法的研究
### 引言
* 信号解码：
  * 无训练解码算法
    * 算法：`CCA`，`FBCCA`
    * 正弦余弦模板：从`SSVEP`共性出发，利用不用被试、不同脑状态之间的共同信息
  * 有训练解码算法：
    * 算法：`TRCA`、`Extended CCA`
    * **个性化模板**：
      * 不仅刻画`SSVEP`的共性，还利用不同被试、不同脑状态之间的差异信息
    * 优势：可更准确对信号进行检测，取得更好的分类效果
    * **缺点**：额外的训练成本
* **迁移算法**：
  * 目标：
    * 保持较高的解码能力
    * 减少`SSVEP-BCI`有训练解码算法的训练时间
    * 降低被试的疲劳程度，改善用户体验
  * 已有研究：
    * 算法：
      * `tt-CCA`：
      * `Adaptive-C3A`：
    * 研究跨被试迁移及跨脑状态迁移
      * 研究意义重大
      * 现阶段对不同被试之间的具体差异、对脑状态的理解缺乏
* 本文工作：
  * 探索跨目标迁移学习的**可行性**及**有效性**
    * 相对于跨被试、跨脑状态，更简单易行
    * 特征:
      * 基波幅度、相位；二次谐波幅度、相位
    * 分析特征随刺激频率变化的规律，验证在不同刺激频率进行迁移的**可行性**
    * 基于`VF`模型的跨目标迁移算法：
      * 利用在相邻频率间`SSVEP`频域特征的连续性
      * 基于抽样训练的方法，即以等间距对所有刺激频率进行抽样
      * 利用最小二乘法辨识模型参数，进而利用插值法得到其他刺激频率处的频率信息，从而重建`SSVEP`信号
      * 将重建的信号模板代替训练模板，对比替换前后`Extended CCA`、无训练算法`FBCCA`的识别正确率和训练时间，验证迁移算法的**有效性**
      
### 实验数据
* 实验设计`->`数据采集
  * **离线实验**：**单目标刺激**、**多目标刺激**
#### 实验被试
* **单目标实验**：
  * 被试人数
  * 视力或矫正视力正常
  * 性别分布
  * 年龄分布：平均年龄
* **多目标实验**：
* 在实验前知道实验内容，通过清华大学伦理委员会的审批
#### 数据采集
* `Synamps2 System(Neuroscan, Inc.)`:
  * 采样率：`1000Hz`
  * 带宽：`1~100Hz`
  * 参考电极：头顶位置
  * 导联：
    * 10-10系统
    * `Pz, PO5, PO3, POz, PO4, PO6, O1, Oz, O2`
  * 电极阻抗：小于`10kΩ`
* 屏蔽室
* `LCD`屏幕：
  * 分辨率：`1920*1080`
  * 刷新率：`60Hz`
  * 尺寸：`23.6寸`
* 被试距离刺激屏幕约`70cm`
#### 实验范式
* **单目标实验**：
  * `block`数目
  * 每个`block`中的目标数目，每个目标中的`trial`数目
  * `16`个目标，对应刺激频率分别为`8 : 0.5 : 15.5Hz`
  * 范式流程
    * `trial`随机呈现
      * `1s`黑屏时间：允许被试快速眨眼，缓解其视觉疲劳
      * `2s`刺激时间：要求被试集中注意力，注视视野中心
    * 刺激目标：
      * 大小：`250*250`像素的正方形
      * 位置：屏幕正中央
      * 其余区域为黑色
      * 调制方式：采样正弦编码
* **多目标实验**：
### 跨目标迁移算法的可行性验证
* **跨目标迁移实质**：
  * 利用同一被试、同一脑状态下不同刺激频率下的`SSVEP`的相关性，将一部分频率下的`SSVEP`推广到其他频率下的`SSVEP`，从而使训练目标数目减少，训练时间缩短
* **跨目标迁移关键**：
  * 挖掘不同刺激下的`SSVEP`信号特征之间的关系
* 某些有训练算法，如扩展`CCA`，利用了`EEG` 叠加平均的训练模板
  * **叠加平均**的本质是降低自发脑电背景噪声，增强诱发脑电成分`SSVEP`，从而提高`SSVEP`的信噪比
  * 对视觉刺激下`SSVEP`信号进行建模
#### 稳态视觉诱发电位幅值特性和相位特性分析
* 同一被试、同一脑状态下相邻刺激频率下的`SSVEP`：
  * 幅值特性应该是**渐变**的
  * **锁时锁相**
* 通过**单目标实验**下的数据进行验证，具体操作：(典型结果)
  * 对不同刺激频率下的`EEG`数据进行**叠加平均**
  * 对不同刺激频率下叠加平均的`EEG`信号进行`FFT`运算，得到`SSVEP`信号的基波和二次谐波的幅度和相位
* 结论：
  * `SSVEP`的基波和二次谐波的幅度对频率变化是**连续**的，即相邻刺激频率下的`SSVEP`的基波和二次谐波的幅度是**相似**的
  * `SSVEP`的基波和二次谐波的相位特性近似为线性相位，即`SSVEP`响应相对于刺激信号的延时是相对稳定的，且与频率无关
* **可行性**成立
### 基于`VF`模型的跨目标迁移算法
* 跨目标迁移算法的**流程图**：
  * 训练频率下的视觉刺激`(叠加平均、傅里叶变换)->`SSVEP`(级联、最小二乘)->`VF模型在训练频率下的频率响应
  * 训练时间、`BCI`识别正确率`<-(评价)`SSVEP信号模板`<-(模板生成)`VF模型在所有刺激频率下的频率响应`<-(多项式插值)`
#### 抽样训练 
* 目标/刺激频率数目`T`
* **等间距**的抽样方法：
  * 从`T`个刺激频率中抽取`Ttrain`个频率做抽样训练
* 单目标实验：
  * 刺激频率总数`T=16`，抽样频率数目`Ttrain=8`，抽样训练频率分别为`8, 9, 10, 11, 12, 13, 14, 15Hz`
  * 每个抽样训练频率：
    * `1`个`block`的数据用于模型的训练
    * `5`个`block`的数据用于评价
  * 训练`trial`数目：`1block * 8target * 5trial = 40trial`
  * 评价`trial`数目：`5block * 16target * 5trial = 400trial`
* 多目标实验：
  * 刺激频率总数`T=40`，抽样频率数目`Ttrain=8`，抽样训练频率分别为`8, 9, 10, 11, 12, 13, 14, 15Hz`
  * 每个抽样训练频率：
    * `5`个`block`的数据用于模型的训练
    * `1`个`block`的数据用于评价
  * 训练`trial`数目：`5block * 8target * 1trial = 40trial`
  * 评价`trial`数目：`1block * 40target * 1trial = 40trial`
#### 模型参数辨识
* 每个**导联**分别学习一个**模型**
* **参数估计的步骤**：
  * 不同刺激频率对应的`SSVEP`及数据矩阵的级联
  * **最小二乘法**
* 模型参数：
  * 时域冲激响应
  * 频域频率响应
    * 一阶频率响应：幅频特性，相频特性
    * 二阶频率响应：幅频特性，相频特性
#### 模板生成
* 生成`SSVEP`的幅值信息：
  * 幅值是渐变的
  * 多项式插值：线性插值
* 生成`SSVEP`的相位信息：
  * 相位近似为线性相位
  * 线性插值
#### 评价指标
* 三个方面：
  * 跨目标迁移算法中估计模板的评价
  * 跨目标迁移算法较少训练有效性的评价
  * `VF`模型在`SSVEP BCI`中有效性验证进行评价
* 两种方式：
  * 估计模板评价：
    * 从频率响应、信号相关性的角度评价估计模板与原始信号
  * 分类性能评价：
    * 替换现有基于信号模板的算法中的模板，对识别正确率和训练时间进行对比
##### 估计信号模板的评价
* 计算所有刺激频率下的原始信号与迁移估计信号的相关系数矩阵
  * 单目标实验
##### 分类性能评价
* 算法：
  * `FBCCA`
  * `Extended CCA`
    * 训练`EEG`信号模板
    * 训练`SSVEP`信号模板
    * 迁移`SSVEP`信号模板
* 单目标实验：
  * **`6`折交叉验证**：
    * 每次抽取`1`个`block`数据进行训练，剩下`5`个`block`数据作为测试
    * 无训练算法`FBCCA`直接在测试数据上进行测试
    * 取`6`次识别正确率的均值作为最终的结果
  * 从应用角度验证`VF`模型在`SSVEP BCI`中有效性：
    * 对比基于训练`SSVEP`信号模板的`Extended CCA`与无训练算法`FBCCA`及基于训练`EEG`信号模板的`Extended CCA`的识别正确率
  * 验证跨目标迁移算法的有效性：
    * 对比基于迁移`SSVEP`信号模板的`Extended CCA`与无训练算法`FBCCA`及基于训练`EEG`信号模板的`Extended CCA`的识别正确率
* 多目标实验：
### 实验结果
#### 迁移`SSVEP`信号模板评价结果
* 跨目标迁移算法估计的迁移`SSVEP`信号频谱与训练`SSVEP`信号频谱的对比：
  * 基波幅度
  * 基波相位
  * 二次谐波幅度
  * 二次谐波相位
  * 结论：
    * 
* 跨目标迁移算法估计的迁移`SSVEP`信号与训练`SSVEP`信号的相关系数矩阵：
  *
  * 结论：
    * 迁移信号与训练信号在相同频率条件下有最强的相关性，且相关系数多分布在。。。
    * 迁移重建得到的信号能最大程度的与训练信号相关
* 结论：
  * 跨目标迁移算法能够对`SSVEP`信号的特性进行有效的跨目标（即不同刺激频率）迁移
#### 分类性能评价结果
##### 单目标实验结果
* 对比基于训练`SSVEP`信号模板的`Extended CCA`与无训练算法`FBCCA`及基于训练`EEG`信号模板的`Extended CCA`的识别正确率：
  * 基于训练`SSVEP`信号模板的`Extended CCA`与基于训练`EEG`信号模板的`Extended CCA`
    * 正确率无显著差异（`p`值）
  * 基于训练`SSVEP`信号模板的`Extended CCA`与无训练算法`FBCCA`
    * 正确率显著提升（`p`值）
  * 结论：
    * 通过以`SSVEP`信号模板代替`EEG`信号模板可以显著提升``SSVEP BCI`的识别正确率，同时从应用的角度验证了`VF`模型在`SSVEP BCI`中的有效性
* 对比基于迁移`SSVEP`信号模板的`Extended CCA`与无训练算法`FBCCA`及基于训练`EEG`信号模板的`Extended CCA`的识别正确率

##### 多目标实验结果

### 讨论
* 跨目标迁移算法的实质：
  * 利用同一个体、同一脑状态下不同刺激频率下`SSVEP`信号特征的相关性
* 通过由简单的单目标实验到更符合实际情况的多目标实验的双重验证，说明跨目标迁移算法在缩短训练时间、保证较高识别正确率有较好的结果
* 下一步研究：
  * 从离线实验扩展到在线实验
* 存在的问题：
  * 建模对象仅为`SSVEP`基波和二次谐波分量，忽略了更高次谐波信息
* 解决方案：
  * 对被试的`SSVEP`更高频成分进行建模
* 进一步研究：
  * 从提升模型参数辨识方法，提升参数插值方法的角度来提升其鲁棒性
  * 从跨目标到跨脑状态
### 结论

  
